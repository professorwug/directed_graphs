---

title: Perrault-Jonas2011's Directed Graph Embeddings


keywords: fastai
sidebar: home_sidebar



nb_path: "40_UW_Manifold_Based_Directed_Embedding.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 40_UW_Manifold_Based_Directed_Embedding.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="directed_diffusion_map" class="doc_header"><code>directed_diffusion_map</code><a href="https://github.com/professorwug/directed_graphs/tree/master/directed_graphs/directed_diffusion_maps.py#L7" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>directed_diffusion_map</code>(<strong><code>W</code></strong>, <strong><code>t</code></strong>=<em><code>1</code></em>, <strong><code>kernel_type</code></strong>=<em><code>'anisotropic'</code></em>, <strong><code>alpha</code></strong>=<em><code>0.5</code></em>, <strong><code>sigma</code></strong>=<em><code>'automatic'</code></em>, <strong><code>k</code></strong>=<em><code>10</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="UW-Directed-Graph-Embedding-Algorithm">UW Directed Graph Embedding Algorithm<a class="anchor-link" href="#UW-Directed-Graph-Embedding-Algorithm"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/directed_graphs/./images/UW_directed_embedding_alg.png" alt="UW Directed Embedding Algorithm"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">UW directed embedding algorithm</span>
<span class="sd">input: W affinity matrix, m embedding dimension</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">def</span> <span class="nf">UW_directed_embedding</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="c1"># steps 1-6 (estimate coordinates according to diffusion map)</span>
    <span class="c1"># step 1</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">W</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># symmetric affinity matrix</span>

    <span class="c1"># step 2</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># degree matrix</span>

    <span class="c1"># step 3</span>
    <span class="n">Qinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Qinv</span><span class="nd">@S@Qinv</span> <span class="c1"># anisotropic normalized affinity matrix</span>

    <span class="c1"># step 4</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># normalized degree matrix</span>
    <span class="n">Q1inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span> <span class="c1"># </span>
    
    <span class="c1"># step 5</span>
    <span class="n">Hss</span> <span class="o">=</span> <span class="n">Q1inv</span><span class="nd">@V</span> <span class="c1"># diffusion matrix (dividing affinity matrix by row sums)</span>

    <span class="c1"># step 6</span>
    <span class="n">eig_vals</span><span class="p">,</span> <span class="n">eig_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Hss</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">eig_vals</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">eig_vals</span> <span class="o">=</span> <span class="n">eig_vals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">eig_vecs</span> <span class="o">=</span> <span class="n">eig_vecs</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span>

    <span class="n">phi</span> <span class="o">=</span> <span class="n">eig_vecs</span><span class="p">[:,:(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># first (m+1) right eigenvectors</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">eig_vecs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># first m significant right eigenvectors (coordinates of points in embedding)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="c1"># diagonal matrix of (m+1) significant eigenvalues</span>


    <span class="c1"># step 7-8: estimate the density</span>
    <span class="n">density</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    evals, evecs = scipy.linalg.eig(Hss, left = True, right = False)</span>
<span class="sd">    pi = evecs[np.where(evals == 1)] # left eigenvector of Hss with eigenvalue 1</span>
<span class="sd">    density = pi/sum(pi) # normalize</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># step 9-13: estimate vector field r</span>
    <span class="c1"># step 9</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># step 10</span>
    <span class="n">Pinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">Pinv</span><span class="nd">@W@Pinv</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">P1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>

    <span class="c1"># step 11</span>
    <span class="n">P1inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span>
    <span class="n">Haa</span> <span class="o">=</span> <span class="n">P1</span><span class="nd">@T</span>

    <span class="n">R</span> <span class="o">=</span> <span class="p">((</span><span class="n">Haa</span> <span class="o">-</span> <span class="n">Hss</span><span class="p">)</span><span class="nd">@phi</span><span class="p">)</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># vector field components in the direction of the corresponding coordinates of the embedding</span>

    <span class="k">return</span> <span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fields</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">fields</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Algorithm-on-(Very-Small)-Toy-Graphs">Algorithm on (Very Small) Toy Graphs<a class="anchor-link" href="#Algorithm-on-(Very-Small)-Toy-Graphs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">directed_graphs.datasets</span> <span class="kn">import</span> <span class="n">SmallRandom</span><span class="p">,</span> <span class="n">visualize_graph</span><span class="p">,</span> <span class="n">ChainGraph2</span><span class="p">,</span> <span class="n">ChainGraph3</span>
<span class="kn">import</span> <span class="nn">torch_geometric</span>
<span class="kn">from</span> <span class="nn">torch_geometric.utils</span> <span class="kn">import</span> <span class="n">to_networkx</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">ChainGraph2</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">visualize_graph</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="UW-algorithm-on-Stochastic-Block-Model">UW-algorithm on Stochastic Block Model<a class="anchor-link" href="#UW-algorithm-on-Stochastic-Block-Model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">directed_graphs.datasets</span> <span class="kn">import</span> <span class="n">DirectedStochasticBlockModelHelper</span>
<span class="kn">from</span> <span class="nn">directed_graphs.datasets</span> <span class="kn">import</span> <span class="n">visualize_heatmap</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">num_clusters</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">edge_index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">DirectedStochasticBlockModelHelper</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">num_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">undir_prob</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">],</span> <span class="n">dir_prob</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="More-(Very-Small)-Toy-Graphs">More (Very Small) Toy Graphs<a class="anchor-link" href="#More-(Very-Small)-Toy-Graphs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="More-Stochastic-Block-Models,-but-better">More Stochastic Block Models, but better<a class="anchor-link" href="#More-Stochastic-Block-Models,-but-better"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch_geometric.data</span> <span class="kn">import</span> <span class="n">Data</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">download_url</span><span class="p">,</span> <span class="n">extract_gz</span>
<span class="kn">from</span> <span class="nn">torch_geometric.utils</span> <span class="kn">import</span> <span class="n">sort_edge_index</span>
<span class="kn">from</span> <span class="nn">torch_sparse</span> <span class="kn">import</span> <span class="n">SparseTensor</span>
<span class="kn">from</span> <span class="nn">torch_geometric.utils</span> <span class="kn">import</span> <span class="n">remove_self_loops</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Stochastic2</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
      <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Stochastic2</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Stochastic3</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
      <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Stochastic3</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Stochastic4</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
      <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Stochastic4</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>

<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bigger-Stochastic-Model">Bigger Stochastic Model<a class="anchor-link" href="#Bigger-Stochastic-Model"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.25</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.5</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">StochasticBig</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">StochasticBig</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>

<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.25</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.5</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">StochasticHuge</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">StochasticHuge</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>

<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">for i in range(int(len(coords)/2)):</span>
<span class="sd">    plt.text(coords[i][0], coords[i][1], i, color = &quot;red&quot;)</span>
<span class="sd">for i in range(int(len(coords)/2), len(coords)):</span>
<span class="sd">    plt.text(coords[i][0], coords[i][1], i, color = &quot;blue&quot;)</span>
<span class="sd">&quot;&quot;&quot;</span>    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Two-Cluster,-no-direction">Two Cluster, no direction<a class="anchor-link" href="#Two-Cluster,-no-direction"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.3</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.3</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">TwoClustNoDirection</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">TwoClustNoDirection</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>

<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">directed_graphs.datasets</span> <span class="kn">import</span> <span class="n">DirectedStochasticBlockModel</span>
<span class="n">aij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]])</span>
<span class="n">bij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.9</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">DirectedStochasticBlockModel</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aij</span> <span class="o">=</span> <span class="n">aij</span><span class="p">,</span> <span class="n">bij</span> <span class="o">=</span> <span class="n">bij</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># there is only graph in this dataset</span>
<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Three-Stohastic-Model">Three Stohastic Model<a class="anchor-link" href="#Three-Stohastic-Model"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.25</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.25</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.75</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">Stochastic3</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Stochastic3</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>

<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
     <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
     <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]]</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>

<span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Three-node-cycle-Meta-graph">Three-node cycle Meta graph<a class="anchor-link" href="#Three-node-cycle-Meta-graph"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.99</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.99</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.99</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.99</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.99</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">.99</span><span class="p">:</span>
            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">ThreeNodeCycle</span><span class="p">(</span><span class="n">InMemoryDataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    
    <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">SparseTensor</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">dense_adj</span><span class="p">)</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">coo</span><span class="p">()</span>
    <span class="n">edge_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_self_loops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="o">=</span><span class="n">edge_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ThreeNodeCycle</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># visualize_graph(data)</span>
<span class="n">visualize_heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">)</span>

<span class="n">sparse_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">edge_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sparse_A</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">UW_directed_embedding</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">visualize_UW_dir_emb</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fields</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fields</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-7.760624715490296e-07
-4.854998847026706e-07
-3.166423718539084e-08
9.126641592431482e-07
8.072926508495676e-07
-4.302516300209772e-07
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>


