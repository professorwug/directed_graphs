---

title: Flow Embedding with Implicit Vectors


keywords: fastai
sidebar: home_sidebar



nb_path: "05a01 Flow_Embedding_with_Implicit_Vectors.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05a01 Flow_Embedding_with_Implicit_Vectors.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GeneralFlowEmbedder" class="doc_header"><code>class</code> <code>GeneralFlowEmbedder</code><a href="https://github.com/professorwug/directed_graphs/tree/master/directed_graphs/embeddings.py#L41" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GeneralFlowEmbedder</code>(<strong><code>graph</code></strong>, <strong><code>dimensions</code></strong>=<em><code>2</code></em>, <strong><code>l_laplacian</code></strong>=<em><code>0.1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-Toy-example">Simple Toy example<a class="anchor-link" href="#Simple-Toy-example"> </a></h2><p>Let first generate a simple example to test our General Flow Embedder with specific functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">directed_graphs.datasets</span> <span class="kn">import</span> <span class="n">ChainGraph</span><span class="p">,</span> <span class="n">CycleGraph</span><span class="p">,</span> <span class="n">visualize_graph</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">CycleGraph</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">visualize_graph</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let also creates a General Flow Embedder object.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">MethodType</span>
<span class="n">flow_embedder</span> <span class="o">=</span> <span class="n">GeneralFlowEmbedder</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">l_laplacian</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-vs-Node2Vec-Initialization">Random vs <code>Node2Vec</code> Initialization<a class="anchor-link" href="#Random-vs-Node2Vec-Initialization"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Random-initialization">Random initialization<a class="anchor-link" href="#Random-initialization"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="k">def</span> <span class="nf">random_initialization</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="n">graph</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emb</span> <span class="o">=</span> <span class="n">random_initialization</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Embedding size = </span><span class="si">{</span><span class="n">emb</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Embedding size = torch.Size([5, 2])
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="k">def</span> <span class="nf">visualize_embedding</span><span class="p">(</span><span class="n">emb</span><span class="p">,</span> <span class="n">flow</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">emb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Embedding has more than 2 dimensions&quot;</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="k">if</span> <span class="n">flow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Flow visualizer has not been implmented&quot;</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="n">nodelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">emb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
  <span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">emb</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">emb</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">legend_elements</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Blobs&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">visualize_embedding</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Node2Vec-initialization"><code>Node2Vec</code> initialization<a class="anchor-link" href="#Node2Vec-initialization"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">karateclub</span> <span class="kn">import</span> <span class="n">Node2Vec</span>
<span class="kn">from</span> <span class="nn">torch_geometric.utils</span> <span class="kn">import</span> <span class="n">to_networkx</span>
<span class="k">def</span> <span class="nf">node2vec_initialization</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">):</span>
  <span class="n">G_nx</span> <span class="o">=</span> <span class="n">to_networkx</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">to_undirected</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">Node2Vec</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">walk_length</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">walk_number</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Performing Node2Vec ...&quot;</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">G_nx</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emb</span> <span class="o">=</span> <span class="n">node2vec_initialization</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Embedding size = </span><span class="si">{</span><span class="n">emb</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Performing Node2Vec ...
Embedding size = (5, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">visualize_embedding</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYoAAAD4CAYAAADy46FuAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAaR0lEQVR4nO3de3RV5Z3/8fc3d5AgEMACQYMVMOGOAS9FiloQ0CXj7TfgrUX9UabaVcfqQp3OOG3XWC2j1VlaGVqt1qq0Y61kKgUVbL1gi0GpAgHkpwiHpBJiFRRy//7+yFGTEDYkZ+eck5PPa62snP3sJ8/zzbM2fLL3OWcfc3dEREQOJy3RBYiISHJTUIiISCAFhYiIBFJQiIhIIAWFiIgEykh0AUH69+/vBQUFiS5DRKTLWL9+/V53HxDmmEkdFAUFBZSWlia6DBGRLsPM3g97TF16EhGRQAoKEREJpKAQEZFASf0cRVvq6uqIRCJUV1cnupTDysnJIT8/n8zMzESXIiISsy4XFJFIhNzcXAoKCjCzRJdzCHenqqqKSCTCsGHDEl2OiHQCd2fngV3UNtZScMwJZKal9h+FXS4oqqurkzYkAMyMvLw8KisrE12KiHSC8oMV3LPtPvbV7cNo+n/ommHzmZxXnODKOk+XfI4iWUPiM8len4h0TIM3cNeWxVTWVFLTWEN1YzXVjdX87L2HKD9YkejyOk0oQWFmM81sq5ltN7Nb2th/rJn9r5n91cw2mdn8MOYVEYmnsn1bqG6oOaS9vrGeP+75UwIqio+Yg8LM0oEHgFlAETDPzIpadbsO2Ozu44BpwN1mlhXr3G1JT09n/PjxjBs3jokTJ7J27VoAduzYwejRowN/9pFHHuH666/vjLJEJAXsr/+kzfZGGvmo7uM4VxM/YTxHMRnY7u7vApjZMmAOsLlZHwdyremaTC/gQ6A+hLkP0aNHDzZs2ADAqlWruPXWW/nTn1I36UUkfkbmDqfBGw5pz07LZlyfsQmoKD7CuPQ0BNjVbDsSbWvufqAQKAfeBr7j7o1tDWZmC8ys1MxKY31CeN++ffTt2/eQ9urqaubPn8+YMWOYMGECL7744uf7du3axcyZMxk5ciTf//73Afj0008577zzGDduHKNHj+bXv/51THWJSNfUL6sfXzvubLLTsj9vy0rL4ks5X+LUfpMSWFnnCuOMoq1nblt/vuq5wAbgbODLwPNm9rK77zvkB92XAksBiouL2/05rQcPHmT8+PFUV1dTUVHBmjVrDunzwAMPAPD222+zZcsWZsyYwbZt2wBYt24dGzdupGfPnkyaNInzzjuP999/n8GDB/Pss88C8PHHqXuKKSLB/nHopYzIHc7qD16kuqGaU/MmMW3gV8lI63IvIj1qYfxmEWBos+18ms4cmpsP3OlNH9C93czeA04G1oUwfwvNLz299tprXHXVVWzcuLFFn1deeYVvf/vbAJx88smccMIJnwfF9OnTycvLA+Ciiy7ilVdeYfbs2dx0000sWrSI888/nzPPPDPsskWkizAzJvadwMS+ExJdStyEcenpdWC4mQ2LPkE9Fyhp1WcncA6AmR0HjATeDWHuQKeffjp79+495D0NTXnVttYvbTUzRowYwfr16xkzZgy33norP/jBDzqlXhGRZBRzULh7PXA9sAooA37j7pvMbKGZLYx2+yFwhpm9DawGFrn73ljnPpItW7bQ0NDw+RnCZ6ZOncrjjz8OwLZt29i5cycjR44E4Pnnn+fDDz/k4MGDPPPMM3zlK1+hvLycnj17csUVV3DTTTfxxhtvdHbpIiJJI5SLau6+AljRqm1Js8flwIww5jqSz56jiM7Lo48+Snp6eos+3/rWt1i4cCFjxowhIyODRx55hOzspienpkyZwpVXXsn27du57LLLKC4uZtWqVdx8882kpaWRmZnJgw8+GI9fRUQkKVjQZZhEKy4u9tYfXFRWVkZhYWGCKjp6XaVOEUktZrbe3UO9n0iXvIWHiIjEj4JCREQCKShERCSQgkJERAIpKEREJJCCQkREAikoOmDlypWMHDmSk046iTvvvDPR5YiIdKqUD4rVT7zM5QX/xIz0/8PlBf/E6idejmm8hoYGrrvuOv7whz+wefNmnnzySTZv3nzkHxQR6aJSOihWP/EyP1mwhD079+Lu7Nm5l58sWBJTWKxbt46TTjqJE088kaysLObOncvy5ctDrFpEJLmkdFA8fNsT1ByobdFWc6CWh297osNj7t69m6FDv7hZbn5+Prt37+7weCIiyS6lg6JyV1W72o9GW7c8aX3HWRGRVJLSQTFgaF672o9Gfn4+u3Z98YF+kUiEwYMHd3g8EZFkl9JBcfUdl5HdM6tFW3bPLK6+47IOjzlp0iTeeecd3nvvPWpr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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Use-simple-random-initialization">Use simple random initialization<a class="anchor-link" href="#Use-simple-random-initialization"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">random_initializer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">))</span>

<span class="n">flow_embedder</span><span class="o">.</span><span class="n">initializer</span> <span class="o">=</span> <span class="n">MethodType</span><span class="p">(</span><span class="n">random_initializer</span><span class="p">,</span> <span class="n">flow_embedder</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emb</span> <span class="o">=</span> <span class="n">flow_embedder</span><span class="o">.</span><span class="n">initializer</span><span class="p">()</span>
<span class="n">visualize_embedding</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Diffusion-cost-on-the-directed-graph">Diffusion cost on the directed graph<a class="anchor-link" href="#Diffusion-cost-on-the-directed-graph"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0 1
1 2
2 3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Energy-cost-in-the-embedding-space">Energy cost in the embedding space<a class="anchor-link" href="#Energy-cost-in-the-embedding-space"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Graph-Laplacian-vs-Embedding-Laplacian">Graph Laplacian vs Embedding Laplacian<a class="anchor-link" href="#Graph-Laplacian-vs-Embedding-Laplacian"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">graph_dense_adj</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">embedding</span><span class="p">):</span>
  <span class="n">sparse_adj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sparse_coo_tensor</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">))</span>
  <span class="n">dense_adj</span> <span class="o">=</span> <span class="n">sparse_adj</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">dense_adj</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">graph_dense_adj</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">emb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0., 1., 0., 0., 0.],
        [0., 0., 1., 0., 0.],
        [0., 0., 0., 1., 0.],
        [0., 0., 0., 0., 1.],
        [1., 0., 0., 0., 0.]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">pairwise_distances</span>
<span class="k">def</span> <span class="nf">emb_dense_adj</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">embedding</span><span class="p">):</span>
  <span class="n">D</span> <span class="o">=</span> <span class="n">pairwise_distances</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
  <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
  <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
  <span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="n">sigmas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="n">k</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
          <span class="n">ei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
          <span class="n">ej</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
          <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ei</span><span class="o">+</span><span class="n">ej</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
          <span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ei</span><span class="o">+</span><span class="n">ej</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
  <span class="k">return</span> <span class="n">W</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emb_dense_adj</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">emb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.        , 0.09105209, 0.09911315, 0.13877136, 0.18428326],
       [0.09105209, 1.        , 0.26737567, 0.04062037, 0.2786097 ],
       [0.09911315, 0.26737567, 1.        , 0.36787944, 0.06561973],
       [0.13877136, 0.04062037, 0.36787944, 1.        , 0.04172318],
       [0.18428326, 0.2786097 , 0.06561973, 0.04172318, 1.        ]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deterministic-Flow-Calculator">Deterministic Flow Calculator<a class="anchor-link" href="#Deterministic-Flow-Calculator"> </a></h2>
</div>
</div>
</div>
</div>


